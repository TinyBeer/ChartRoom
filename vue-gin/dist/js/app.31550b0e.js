(function(t){function e(e){for(var o,c,i=e[0],u=e[1],s=e[2],l=0,d=[];l<i.length;l++)c=i[l],Object.prototype.hasOwnProperty.call(r,c)&&r[c]&&d.push(r[c][0]),r[c]=0;for(o in u)Object.prototype.hasOwnProperty.call(u,o)&&(t[o]=u[o]);f&&f(e);while(d.length)d.shift()();return a.push.apply(a,s||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],o=!0,c=1;c<n.length;c++){var u=n[c];0!==r[u]&&(o=!1)}o&&(a.splice(e--,1),t=i(i.s=n[0]))}return t}var o={},r={app:0},a=[];function c(t){return i.p+"js/"+({about:"about"}[t]||t)+"."+{about:"362537e4","chunk-17958394":"e85164e0","chunk-cab9dc70":"50330277"}[t]+".js"}function i(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.e=function(t){var e=[],n=r[t];if(0!==n)if(n)e.push(n[2]);else{var o=new Promise((function(e,o){n=r[t]=[e,o]}));e.push(n[2]=o);var a,u=document.createElement("script");u.charset="utf-8",u.timeout=120,i.nc&&u.setAttribute("nonce",i.nc),u.src=c(t);var s=new Error;a=function(e){u.onerror=u.onload=null,clearTimeout(l);var n=r[t];if(0!==n){if(n){var o=e&&("load"===e.type?"missing":e.type),a=e&&e.target&&e.target.src;s.message="Loading chunk "+t+" failed.\n("+o+": "+a+")",s.name="ChunkLoadError",s.type=o,s.request=a,n[1](s)}r[t]=void 0}};var l=setTimeout((function(){a({type:"timeout",target:u})}),12e4);u.onerror=u.onload=a,document.head.appendChild(u)}return Promise.all(e)},i.m=t,i.c=o,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(n,o,function(e){return t[e]}.bind(null,o));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/",i.oe=function(t){throw console.error(t),t};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],s=u.push.bind(u);u.push=e,u=u.slice();for(var l=0;l<u.length;l++)e(u[l]);var f=s;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("2b0e"),r=n("5f5b"),a=n("b1e0"),c=n("1dce"),i=n.n(c),u=n("bc3a"),s=n.n(u),l=n("2106"),f=n.n(l),d=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("navbar"),n("b-container",[n("router-view")],1)],1)},p=[],m=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-navbar",{attrs:{toggleable:"lg",type:"dark",variant:"info"}},[n("b-container",[n("b-navbar-brand",{on:{click:function(e){return t.$router.replace({name:"Home"})}}},[t._v("TinyBeer")]),n("b-navbar-toggle",{attrs:{target:"nav-collapse"}}),n("b-collapse",{attrs:{id:"nav-collapse","is-nav":""}},[n("b-navbar-nav",{staticClass:"ml-auto"},[t.userInfo?n("b-nav-item-dropdown",{attrs:{left:""},scopedSlots:t._u([{key:"button-content",fn:function(){return[n("em",[t._v(" "+t._s(t.userInfo.name)+" ")])]},proxy:!0}],null,!1,3141649579)},[n("b-dropdown-item",{attrs:{href:"#"}},[t._v("个人主页")]),n("b-dropdown-item",{on:{click:t.logout}},[t._v("登出")])],1):t._e()],1),t.userInfo?t._e():n("b-navbar-nav",["login"!=t.$route.name?n("b-nav-item",{on:{click:function(e){return t.$router.replace({name:"login"})}}},[t._v("登录")]):t._e(),"register"!=t.$route.name?n("b-nav-item",{on:{click:function(e){return t.$router.replace({name:"register"})}}},[t._v("注册")]):t._e()],1)],1)],1)],1)],1)},b=[],h=n("5530"),v=(n("5319"),n("ac1f"),n("2f62")),g={computed:Object(v["c"])({userInfo:function(t){return t.userModule.userInfo}}),methods:Object(h["a"])(Object(h["a"])({},Object(v["b"])("userModule",{userLogout:"logout"})),{},{logout:function(){this.userLogout(),this.$router.replace({name:"login"})}})},_=g,E=n("2877"),O=Object(E["a"])(_,m,b,!1,null,"06fc5839",null),k=O.exports,w={components:{Navbar:k},data:function(){return{}}},S=w,y=Object(E["a"])(S,d,p,!1,null,null,null),j=y.exports,x=n("2909"),T=(n("99af"),n("d3b7"),n("3ca3"),n("ddb0"),n("8c4f")),N=(n("b0c0"),"ginessential_"),C="".concat(N,"user_"),I="".concat(C,"token"),U="".concat(C,"info"),P=function(t,e){localStorage.setItem(t,e)},R=function(t){return localStorage.getItem(t)},M={set:P,get:R,USER_TOKEN:I,USER_INFO:U},$=s.a.create({baseURL:"http://3843359ku3.wicp.vip:33005/api",timeout:5e4,headers:{Authorization:"Bearer ".concat(M.get(M.USER_TOKEN))}});$.interceptors.request.use((function(t){return Object.assign(t.headers,{Authorization:"Bearer ".concat(M.get(M.USER_TOKEN))}),t}),(function(t){return Promise.reject(t)}));var K=$,F=function(t){var e=t.name,n=t.id,o=t.password;return K.post("auth/register",{name:e,id:n,password:o})},A=function(){return K.get("auth/info")},L=function(t){var e=t.id,n=t.password;return K.post("auth/login",{id:e,password:n})},G=function(t){return K.post("auth/speak",t)},B=function(t){return K.get("auth/content/".concat(t))},J={register:F,info:A,login:L,speak:G,getContent:B},H={namespaced:!0,state:{token:M.get(M.USER_TOKEN),userInfo:M.get(M.USER_INFO)?JSON.parse(M.get(M.USER_INFO)):null},mutations:{SET_TOKEN:function(t,e){M.set(M.USER_TOKEN,e),t.token=e},SET_USERINFO:function(t,e){M.set(M.USER_INFO,JSON.stringify(e)),t.userInfo=e}},actions:{register:function(t,e){var n=e.name,o=e.id,r=e.password;return new Promise((function(e,a){J.register({name:n,id:o,password:r}).then((function(e){return t.commit("SET_TOKEN",e.data.data.token),J.info()})).then((function(n){t.commit("SET_USERINFO",n.data.data.user),e(n)})).catch((function(t){a(t)}))}))},login:function(t,e){var n=e.id,o=e.password;return new Promise((function(e,r){J.login({id:n,password:o}).then((function(e){return t.commit("SET_TOKEN",e.data.data.token),J.info()})).then((function(n){t.commit("SET_USERINFO",n.data.data.user),e(n)})).catch((function(t){r(t)}))}))},speak:function(t,e){return new Promise((function(t,n){J.speak(e).then((function(e){t(e)})).catch((function(t){n(t)}))}))},getContent:function(t,e){return new Promise((function(t,n){J.getContent(e).then((function(e){t(e)})).catch((function(t){n(t)}))}))},logout:function(t){var e=t.commit;e("SET_TOKEN",""),e("SET_USERINFO","")}}},V=H;o["default"].use(v["a"]);var q=new v["a"].Store({strict:"production"!==Object({NODE_ENV:"production",VUE_APP_BASE_URL:"http://3843359ku3.wicp.vip:33005/api",BASE_URL:"/"}).MODE_ENV,state:{},mutations:{},actions:{},modules:{userModule:V}}),z=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"home"},[n("b-container",[n("b-card",{staticClass:"mt-2"},[n("b-form-textarea",{ref:"content",attrs:{id:"content",rows:"10","max-rows":"10",plaintext:""},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1),n("b-card",[n("div",[n("b-form-textarea",{attrs:{id:"textarea",placeholder:"Enter something...",rows:"3","max-rows":"6"},model:{value:t.text,callback:function(e){t.text=e},expression:"text"}})],1),n("b-container",{staticClass:"mt-2"},[n("b-row",[n("b-col",{attrs:{cols:"12",md:"4"}}),n("b-col",{attrs:{cols:"12",md:"2"}},[n("b-button",{staticClass:"mt-1",attrs:{variant:"primary",pill:"",block:""},on:{click:t.speak}},[t._v("发送")])],1),n("b-col",{attrs:{cols:"12",md:"2"}},[n("b-button",{staticClass:"mt-1",attrs:{variant:"success",pill:"",block:""},on:{click:t.getContent}},[t._v(t._s(t.btnGetContent)+" ")])],1),n("b-col",{attrs:{cols:"12",md:"4"}})],1)],1)],1)],1)],1)},D=[],Q=(n("159b"),{name:"Home",data:function(){return{content:"",text:"",content_id:0,timer:null,btnGetContent:"开始接收"}},methods:Object(h["a"])(Object(h["a"])({},Object(v["b"])("userModule",{userSpeak:"speak",userGetContent:"getContent"})),{},{speak:function(){var t=this;if(""===this.text)return console.log("输入为空"),void this.$bvToast.toast("输入不能为空",{title:"输入为空",variant:"danger",solid:!0});this.userSpeak(this.text).then((function(e){t.text="",console.log(e.data.data)})).catch((function(t){console.log(t)}))},getContent:function(){var t=this;if(console.log(this.timer),this.timer)return clearInterval(this.timer),this.timer=null,void(this.btnGetContent="开始接收");this.btnGetContent="停止接收",this.timer=setInterval((function(){t.userGetContent(t.content_id).then((function(e){t.content_id=e.data.data.content_id,e.data.data.content&&e.data.data.content.forEach((function(e){t.content="".concat(e.speaker.name,":").concat(e.content,"\n").concat(t.content)}))})).catch((function(t){console.log(t)}))}),1e3)}})}),W=Q,X=Object(E["a"])(W,z,D,!1,null,null,null),Y=X.exports,Z=[{path:"/register",name:"register",component:function(){return n.e("chunk-17958394").then(n.bind(null,"0f9e"))}},{path:"/login",name:"login",component:function(){return n.e("chunk-cab9dc70").then(n.bind(null,"ede4"))}}],tt=Z;o["default"].use(T["a"]);var et=[{path:"/",name:"Home",meta:{auth:!0},component:Y},{path:"/about",name:"About",component:function(){return n.e("about").then(n.bind(null,"f820"))}}].concat(Object(x["a"])(tt)),nt=new T["a"]({mode:"history",base:"/",routes:et});nt.beforeEach((function(t,e,n){t.meta.auth?(console.log(q.state.userModule.token),q.state.userModule.token?n():nt.push({name:"login"})):n()}));var ot=nt;n("a41b");o["default"].config.productionTip=!1,o["default"].use(r["a"]),o["default"].use(a["a"]),o["default"].use(i.a),o["default"].use(f.a,s.a),new o["default"]({router:ot,store:q,render:function(t){return t(j)}}).$mount("#app")},a41b:function(t,e,n){}});
//# sourceMappingURL=app.31550b0e.js.map